<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" class="alectryon-standalone" xml:lang="en" lang="en">
<head>
<meta charset="utf-8" />
<meta name="generator" content="Docutils 0.21.2: https://docutils.sourceforge.io/" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Specialization of module argument in Coq</title>
<link rel="stylesheet" href="alectryon.css" type="text/css" />
<link rel="stylesheet" href="docutils_basic.css" type="text/css" />
<link rel="stylesheet" href="pygments.css" type="text/css" />
<script type="text/javascript" src="alectryon.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="alectryon-root alectryon-centered"><main id="specialization-of-module-argument-in-coq">
<h1 class="title">Specialization of module argument in Coq</h1>
<dl class="docinfo simple">
<dt class="link">Link<span class="colon">:</span></dt>
<dd class="link"><p><a class="reference external" href="https://stackoverflow.com/q/54703204">https://stackoverflow.com/q/54703204</a></p>
</dd>
</dl>
<input type="checkbox" class="alectryon-toggle" id="alectryon-toggle-0" /><label for="alectryon-toggle-0" class="alectryon-toggle-label">Display all goals and responses</label><div class="alectryon-container docutils container">
<section id="question">
<h2>Question</h2>
<p>I have a module and I need to specialize one of its argument. I want
to use natural numbers instead of arbitrary
<span class="docutils literal">UsualDecidableTypeFull</span>. How can I obtain such behaviour in Coq?</p>
<p>I defined some module:</p>
<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Module</span> <span class="nf">PRO2PRE_mod</span>
       (SetVars FuncSymb PredSymb PropSymb: UsualDecidableTypeFull).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  <span class="c">(* ... *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">PRO2PRE_mod</span>.</span></span></pre><p>Then I specialized the last of the arguments <span class="docutils literal">PropSymb</span>.</p>
<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> Arith.PeanoNat.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Module</span> <span class="nf">m2</span> : UsualDecidableTypeFull.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">t</span> := nat.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">eq</span> := @eq nat.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">eq_refl</span> := @eq_refl nat.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">eq_sym</span> := @eq_sym nat.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">eq_trans</span> := @eq_trans nat.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">eq_equiv</span> : Equivalence eq := Nat.eq_equiv.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">eq_dec</span> := Nat.eq_dec.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">eqb</span> := Nat.eqb.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">eqb_eq</span> := Nat.eqb_eq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">m2</span>.</span></span></pre><p>This module needs specialization of <span class="docutils literal">PropVars</span>:</p>
<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Module</span> <span class="nf">SWAP_mod</span>
       (SetVars FuncSymb PredSymb : UsualDecidableTypeFull).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Module</span> <span class="nf">PRE</span> := PRO2PRE_mod SetVars FuncSymb PredSymb m2.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Import</span> PRE.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="specialization-of-module-argument-in-coq-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="specialization-of-module-argument-in-coq-v-chk0"><span class="kn">Theorem</span> <span class="nf">test</span> : m2.t.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">m2.t</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="specialization-of-module-argument-in-coq-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input alectryon-failed" for="specialization-of-module-argument-in-coq-v-chk1"><span class="bp">exact</span> <span class="mi">0</span>. <span class="c">(* ERROR HERE! *)</span></label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">The term <span class="s2">&quot;0&quot;</span> has type <span class="s2">&quot;nat&quot;</span>
while it <span class="kr">is</span> expected to <span class="nb">have</span> type <span class="s2">&quot;m2.t&quot;</span>.</blockquote></div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">m2.t</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Abort</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">SWAP_mod</span>.</span></span></pre><p>How to use theorems about natural numbers inside the last module? (I
think I don't understand something about using modules... Maybe we
need somehow to coerce the type <span class="docutils literal">m2.t</span> to the type <span class="docutils literal">nat</span>?)</p>
</section>
<section id="answer">
<h2>Answer</h2>
<p>Indeed, the use of <span class="docutils literal">: UsualDecidableTypeFull</span> in the definition of
<span class="docutils literal">m2</span> hides completely the implementation details of <span class="docutils literal">m2</span>. From the
outside, <span class="docutils literal">m2.t</span> is an unknown type.</p>
<p>Sometimes, this is exactly what you want. For example, you may want to
abstract away a type defined in a module so that the users cannot
manipulate values of this type without using the functions that you
gave to them in the module. You can thus ensure that they will not
break some invariants.</p>
<p>However, in your case, you need to remember that <span class="docutils literal">m2.t</span> is actually
<span class="docutils literal">nat</span>, you have at least these two options:</p>
<ul>
<li><p>Make the interface transparent with <span class="docutils literal">Module m2 &lt;: UsualDecidableTypeFull</span>. When using this, Coq just verifies that
the definition of the module complies with the signature, but does
not hide the content of the module.</p></li>
<li><p>If you still want to hide part of the module, you can also use</p>
<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Module</span> <span class="nf">m2</span> : UsualDecidableTypeFull <span class="kr">with</span> <span class="kn">Definition</span> <span class="nf">t</span> := nat.</span></span></pre><p>In this case, from the outside, <span class="docutils literal">m2.t</span> is known to be <span class="docutils literal">nat</span>, but
the other fields of <span class="docutils literal">m</span> are masked. For instance, the body of
<span class="docutils literal">m2.eqb</span> is hidden.</p>
</li>
</ul>
</section>
</div>
</main>
</div></body>
</html>
