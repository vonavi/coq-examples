<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="alectryon-standalone" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<title>Specialization of module argument in Coq</title>
<link rel="stylesheet" href="alectryon.css" type="text/css" />
<link rel="stylesheet" href="docutils_basic.css" type="text/css" />
<link rel="stylesheet" href="pygments.css" type="text/css" />
<script type="text/javascript" src="alectryon.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="alectryon-root alectryon-centered"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.13.0+0.13.0. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><div class="document" id="specialization-of-module-argument-in-coq">
<h1 class="title">Specialization of module argument in Coq</h1>
<table class="docinfo" frame="void" rules="none">
<col class="docinfo-name" />
<col class="docinfo-content" />
<tbody valign="top">
<tr class="link field"><th class="docinfo-name">Link:</th><td class="field-body"><a class="reference external" href="https://stackoverflow.com/q/54703204">https://stackoverflow.com/q/54703204</a></td>
</tr>
</tbody>
</table>
<input type="checkbox" class="alectryon-toggle" id="alectryon-toggle-0" /><label for="alectryon-toggle-0" class="alectryon-toggle-label">Display all goals and responses</label><div class="alectryon-container docutils container">
<div class="section" id="question">
<h1>Question</h1>
<p>I have a module and I need to specialize one of its argument. I want
to use natural numbers instead of arbitrary
<tt class="docutils literal">UsualDecidableTypeFull</tt>. How can I obtain such behaviour in Coq?</p>
<p>I defined some module:</p>
<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Module</span> <span class="nf">PRO2PRE_mod</span>
       (SetVars FuncSymb PredSymb PropSymb: UsualDecidableTypeFull).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  <span class="c">(* ... *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">PRO2PRE_mod</span>.</span></span></pre><p>Then I specialized the last of the arguments <tt class="docutils literal">PropSymb</tt>.</p>
<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> Arith.PeanoNat.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Module</span> <span class="nf">m2</span> : UsualDecidableTypeFull.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">t</span> := nat.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">eq</span> := @eq nat.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">eq_refl</span> := @eq_refl nat.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">eq_sym</span> := @eq_sym nat.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">eq_trans</span> := @eq_trans nat.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">eq_equiv</span> : Equivalence eq := Nat.eq_equiv.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">eq_dec</span> := Nat.eq_dec.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">eqb</span> := Nat.eqb.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">eqb_eq</span> := Nat.eqb_eq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">m2</span>.</span></span></pre><p>This module needs specialization of <tt class="docutils literal">PropVars</tt>:</p>
<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Module</span> <span class="nf">SWAP_mod</span>
       (SetVars FuncSymb PredSymb : UsualDecidableTypeFull).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Module</span> <span class="nf">PRE</span> := PRO2PRE_mod SetVars FuncSymb PredSymb m2.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Import</span> PRE.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="specialization-of-module-argument-in-coq-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="specialization-of-module-argument-in-coq-v-chk0"><span class="kn">Theorem</span> <span class="nf">test</span> : m2.t.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">m2.t</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="specialization-of-module-argument-in-coq-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input alectryon-failed" for="specialization-of-module-argument-in-coq-v-chk1"><span class="bp">exact</span> <span class="mi">0</span>. <span class="c">(* ERROR HERE! *)</span></label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">The term <span class="s2">&quot;0&quot;</span> has type <span class="s2">&quot;nat&quot;</span>
while it <span class="kr">is</span> expected to <span class="nb">have</span> type <span class="s2">&quot;m2.t&quot;</span>.</blockquote></div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">m2.t</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Abort</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">SWAP_mod</span>.</span></span></pre><p>How to use theorems about natural numbers inside the last module? (I
think I don't understand something about using modules... Maybe we
need somehow to coerce the type <tt class="docutils literal">m2.t</tt> to the type <tt class="docutils literal">nat</tt>?)</p>
</div>
<div class="section" id="answer">
<h1>Answer</h1>
<p>Indeed, the use of <tt class="docutils literal">: UsualDecidableTypeFull</tt> in the definition of
<tt class="docutils literal">m2</tt> hides completely the implementation details of <tt class="docutils literal">m2</tt>. From the
outside, <tt class="docutils literal">m2.t</tt> is an unknown type.</p>
<p>Sometimes, this is exactly what you want. For example, you may want to
abstract away a type defined in a module so that the users cannot
manipulate values of this type without using the functions that you
gave to them in the module. You can thus ensure that they will not
break some invariants.</p>
<p>However, in your case, you need to remember that <tt class="docutils literal">m2.t</tt> is actually
<tt class="docutils literal">nat</tt>, you have at least these two options:</p>
<ul>
<li><p class="first">Make the interface transparent with <tt class="docutils literal">Module m2 &lt;:
UsualDecidableTypeFull</tt>. When using this, Coq just verifies that
the definition of the module complies with the signature, but does
not hide the content of the module.</p>
</li>
<li><p class="first">If you still want to hide part of the module, you can also use</p>
<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Module</span> <span class="nf">m2</span> : UsualDecidableTypeFull <span class="kr">with</span> <span class="kn">Definition</span> <span class="nf">t</span> := nat.</span></span></pre><p>In this case, from the outside, <tt class="docutils literal">m2.t</tt> is known to be <tt class="docutils literal">nat</tt>, but
the other fields of <tt class="docutils literal">m</tt> are masked. For instance, the body of
<tt class="docutils literal">m2.eqb</tt> is hidden.</p>
</li>
</ul>
</div>
</div>
</div>
</div></body>
</html>
