<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" class="alectryon-standalone" xml:lang="en" lang="en">
<head>
<meta charset="utf-8" />
<meta name="generator" content="Docutils 0.21.2: https://docutils.sourceforge.io/" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Coq: Implementation of split_string and proof that nothing gets deleted</title>
<link rel="stylesheet" href="alectryon.css" type="text/css" />
<link rel="stylesheet" href="docutils_basic.css" type="text/css" />
<link rel="stylesheet" href="pygments.css" type="text/css" />
<script type="text/javascript" src="alectryon.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="alectryon-root alectryon-centered"><main id="coq-implementation-of-split-string-and-proof-that-nothing-gets-deleted">
<h1 class="title">Coq: Implementation of <span class="docutils literal">split_string</span> and proof that nothing gets deleted</h1>
<dl class="docinfo simple">
<dt class="link">Link<span class="colon">:</span></dt>
<dd class="link"><p><a class="reference external" href="https://stackoverflow.com/q/73026651">https://stackoverflow.com/q/73026651</a></p>
</dd>
</dl>
<input type="checkbox" class="alectryon-toggle" id="alectryon-toggle-0" /><label for="alectryon-toggle-0" class="alectryon-toggle-label">Display all goals and responses</label><div class="alectryon-container docutils container">
<section id="question">
<h2>Question</h2>
<p>After working for a whole day on this with no success, I might get
some help here. I implemented a splitString function in Coq: It takes
a String (In my case a <span class="docutils literal">list ascii</span>) and a function <span class="docutils literal">f : ascii <span class="pre">-&gt;</span> bool</span>. I want to return a list of strings (In my case a <span class="docutils literal">list (list ascii)</span>) containing all the substrings. This means that the input
string has been split at all <span class="docutils literal">ascii</span>s where f is true. Note that
my output also includes the delimiter as a string (<span class="docutils literal">list ascii</span>) of
length 1.</p>
<p>My first question: exists this function in a library somewhere? Many
other, non-functional, programming languages I know includes this
function in the default library.</p>
<p>I didn't found something, so I implemented it by myself:</p>
<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">split_string</span> (<span class="nv">f</span> : ascii -&gt; bool) (<span class="nv">z</span> <span class="nv">s</span> : list ascii): list (list ascii) :=
  <span class="kr">match</span> s <span class="kr">with</span>
  | [] =&gt; [rev z]
  | h :: t =&gt; <span class="kr">match</span> f h <span class="kr">with</span>
              | true =&gt; ([rev z] ++ [[h]]) ++ split_string f [] t
              | false =&gt; split_string f (h :: z) t
              <span class="kr">end</span>
  <span class="kr">end</span>.</span></span></pre><p>The function needs to be called with an empty <span class="docutils literal">z</span>, like <span class="docutils literal">Compute split_string isWhite [] some_string.</span></p>
<p>The clue of that List <span class="docutils literal">z</span> is that the current string gets saved in
it until a delimiter is found, then the whole string <span class="docutils literal">z</span> gets
returned. I don't see another way of solving this.</p>
<p>The problem with the List <span class="docutils literal">z</span> is that, when it comes to proofing, it
makes trouble.</p>
<p>I want to proove that, when the output of the splitString function
gets flattened (in Coq with <span class="docutils literal">concat</span>) it is equal to the input,
because the splitString method does not remove information. I
formulated a theorem:</p>
<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk0"><span class="kn">Theorem</span> <span class="nf">not_more_not_less_splitWhite</span> : <span class="kr">forall</span> <span class="nv">s</span> : list ascii,
    s = concat (split_string isWhite [] s).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">s</span> : list ascii,
s = concat (split_string isWhite [] s)</div></blockquote></div></div></small></span></pre><p>But every time when I try to solve this with induction, I get stuck
because the List <span class="docutils literal">z</span> is not empty anymore (since one char which is
not white has been processed). Then I can never apply the induction
hypothesis. This is how far I've made it:</p>
<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">s</span> : list ascii,
s = concat (split_string isWhite [] s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk2"><span class="nb">intros</span> s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>list ascii</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s = concat (split_string isWhite [] s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk3"><span class="nb">induction</span> s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">[] = concat (split_string isWhite [] [])</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>ascii</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list ascii</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>s = concat (split_string isWhite [] s)</span></span></span><br></div><label class="goal-separator" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk4"><hr></label><div class="goal-conclusion">a :: s = concat (split_string isWhite [] (a :: s))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">[] = concat (split_string isWhite [] [])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk6"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">[] = []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>ascii</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list ascii</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>s = concat (split_string isWhite [] s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a :: s = concat (split_string isWhite [] (a :: s))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk8"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>ascii</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list ascii</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>s = concat (split_string isWhite [] s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a :: s =
concat
  (<span class="kr">if</span> isWhite a
   <span class="kr">then</span> [] :: [a] :: split_string isWhite [] s
   <span class="kr">else</span> split_string isWhite [a] s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk9"><span class="nb">destruct</span> isWhite <span class="nb">eqn</span>:W.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>ascii</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list ascii</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>s = concat (split_string isWhite [] s)</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>isWhite a = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a :: s =
concat ([] :: [a] :: split_string isWhite [] s)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chka" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>ascii</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list ascii</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>s = concat (split_string isWhite [] s)</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>isWhite a = false</span></span></span><br></div><label class="goal-separator" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chka"><hr></label><div class="goal-conclusion">a :: s = concat (split_string isWhite [a] s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chkb">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>ascii</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list ascii</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>s = concat (split_string isWhite [] s)</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>isWhite a = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a :: s =
concat ([] :: [a] :: split_string isWhite [] s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chkc"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>ascii</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list ascii</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>s = concat (split_string isWhite [] s)</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>isWhite a = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a :: s = a :: concat (split_string isWhite [] s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chkd"><span class="nb">rewrite</span> &lt;- IHs.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>ascii</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list ascii</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>s = concat (split_string isWhite [] s)</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>isWhite a = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a :: s = a :: s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chke">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>ascii</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list ascii</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>s = concat (split_string isWhite [] s)</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>isWhite a = false</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a :: s = concat (split_string isWhite [a] s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span></pre><p>I found myself in willing to induce in <span class="docutils literal">s</span> a second time, but I
think this is bullshit and does not use the power of induction. So, if
the answer to my first question is no, my second question is how do I
solve this, or is there a better implementation for <span class="docutils literal">split_string</span>.</p>
</section>
<section id="answer-ana-borges">
<h2>Answer (Ana Borges)</h2>
<p>This problem is common whenever proving things by induction about a
fixpoint with an accumulator, such as yours. The standard advice is to
find a stronger statement that has your desired result as a corollary.
This stronger statement should be about all lists, not only the empty
list. The latter should hopefully be easier to prove with induction,
since the stronger statement leads to a stronger induction hypothesis.</p>
<p>In your case, I guess (but haven't checked) the stronger statement
could be something like:</p>
<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chkf"><span class="kn">Theorem</span> <span class="nf">not_more_not_less_splitWhite_stronger</span> : <span class="kr">forall</span> (<span class="nv">z</span> <span class="nv">s</span> : list ascii),
    rev z ++ s = concat (split_string isWhite z s).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">z</span> <span class="nv">s</span> : list ascii,
rev z ++ s = concat (split_string isWhite z s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span></pre></section>
<section id="answer-pierre-casteran">
<h2>Answer (Pierre Cast√©ran)</h2>
<p>Here is a proof of your theorem:</p>
<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk10"><span class="kn">Goal</span> <span class="kr">forall</span> <span class="nv">p</span> <span class="nv">l</span> <span class="nv">buf</span>, rev buf ++ l = concat (split_string p buf l).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">p</span> : ascii -&gt; bool) (<span class="nv">l</span> <span class="nv">buf</span> : list ascii),
rev buf ++ l = concat (split_string p buf l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk11"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">p</span> : ascii -&gt; bool) (<span class="nv">l</span> <span class="nv">buf</span> : list ascii),
rev buf ++ l = concat (split_string p buf l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk12"><span class="nb">induction</span> l <span class="kr">as</span> [ | a l IHl].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>p</var><span class="hyp-type"><b>: </b><span>ascii -&gt; bool</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">buf</span> : list ascii,
rev buf ++ [] = concat (split_string p buf [])</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk13" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>p</var><span class="hyp-type"><b>: </b><span>ascii -&gt; bool</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>ascii</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list ascii</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">buf</span> : list ascii, rev buf ++ l = concat (split_string p buf l)</span></span></span><br></div><label class="goal-separator" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk13"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">buf</span> : list ascii,
rev buf ++ a :: l =
concat (split_string p buf (a :: l))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk14">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>p</var><span class="hyp-type"><b>: </b><span>ascii -&gt; bool</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">buf</span> : list ascii,
rev buf ++ [] = concat (split_string p buf [])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk15"><span class="nb">intro</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>p</var><span class="hyp-type"><b>: </b><span>ascii -&gt; bool</span></span></span><br><span><var>buf</var><span class="hyp-type"><b>: </b><span>list ascii</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">rev buf ++ [] = concat (split_string p buf [])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">cbn</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk16">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>p</var><span class="hyp-type"><b>: </b><span>ascii -&gt; bool</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>ascii</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list ascii</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">buf</span> : list ascii, rev buf ++ l = concat (split_string p buf l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">buf</span> : list ascii,
rev buf ++ a :: l =
concat (split_string p buf (a :: l))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk17"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>p</var><span class="hyp-type"><b>: </b><span>ascii -&gt; bool</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>ascii</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list ascii</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">buf</span> : list ascii, rev buf ++ l = concat (split_string p buf l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">buf</span> : list ascii,
rev buf ++ a :: l =
concat
  (<span class="kr">if</span> p a
   <span class="kr">then</span> rev buf :: [a] :: split_string p [] l
   <span class="kr">else</span> split_string p (a :: buf) l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk18"><span class="nb">case_eq</span> (p a); <span class="nb">intro</span> Ha.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>p</var><span class="hyp-type"><b>: </b><span>ascii -&gt; bool</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>ascii</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list ascii</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">buf</span> : list ascii, rev buf ++ l = concat (split_string p buf l)</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>p a = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">buf</span> : list ascii,
rev buf ++ a :: l =
concat (rev buf :: [a] :: split_string p [] l)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk19" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>p</var><span class="hyp-type"><b>: </b><span>ascii -&gt; bool</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>ascii</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list ascii</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">buf</span> : list ascii, rev buf ++ l = concat (split_string p buf l)</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>p a = false</span></span></span><br></div><label class="goal-separator" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk19"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">buf</span> : list ascii,
rev buf ++ a :: l =
concat (split_string p (a :: buf) l)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk1a">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>p</var><span class="hyp-type"><b>: </b><span>ascii -&gt; bool</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>ascii</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list ascii</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">buf</span> : list ascii, rev buf ++ l = concat (split_string p buf l)</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>p a = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">buf</span> : list ascii,
rev buf ++ a :: l =
concat (rev buf :: [a] :: split_string p [] l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk1b"><span class="nb">intro</span> buf.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>p</var><span class="hyp-type"><b>: </b><span>ascii -&gt; bool</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>ascii</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list ascii</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">buf</span> : list ascii, rev buf ++ l = concat (split_string p buf l)</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>p a = true</span></span></span><br><span><var>buf</var><span class="hyp-type"><b>: </b><span>list ascii</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">rev buf ++ a :: l =
concat (rev buf :: [a] :: split_string p [] l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk1c"><span class="kp">repeat</span> <span class="nb">rewrite</span> concat_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>p</var><span class="hyp-type"><b>: </b><span>ascii -&gt; bool</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>ascii</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list ascii</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">buf</span> : list ascii, rev buf ++ l = concat (split_string p buf l)</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>p a = true</span></span></span><br><span><var>buf</var><span class="hyp-type"><b>: </b><span>list ascii</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">rev buf ++ a :: l =
rev buf ++ [a] ++ concat (split_string p [] l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> &lt;- IHl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk1d">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>p</var><span class="hyp-type"><b>: </b><span>ascii -&gt; bool</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>ascii</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list ascii</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">buf</span> : list ascii, rev buf ++ l = concat (split_string p buf l)</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>p a = false</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">buf</span> : list ascii,
rev buf ++ a :: l =
concat (split_string p (a :: buf) l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk1e"><span class="nb">intro</span> buf.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>p</var><span class="hyp-type"><b>: </b><span>ascii -&gt; bool</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>ascii</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list ascii</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">buf</span> : list ascii, rev buf ++ l = concat (split_string p buf l)</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>p a = false</span></span></span><br><span><var>buf</var><span class="hyp-type"><b>: </b><span>list ascii</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">rev buf ++ a :: l =
concat (split_string p (a :: buf) l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk1f"><span class="nb">rewrite</span> &lt;- IHl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>p</var><span class="hyp-type"><b>: </b><span>ascii -&gt; bool</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>ascii</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list ascii</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">buf</span> : list ascii, rev buf ++ l = concat (split_string p buf l)</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>p a = false</span></span></span><br><span><var>buf</var><span class="hyp-type"><b>: </b><span>list ascii</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">rev buf ++ a :: l = rev (a :: buf) ++ l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk20"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>p</var><span class="hyp-type"><b>: </b><span>ascii -&gt; bool</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>ascii</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list ascii</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">buf</span> : list ascii, rev buf ++ l = concat (split_string p buf l)</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>p a = false</span></span></span><br><span><var>buf</var><span class="hyp-type"><b>: </b><span>list ascii</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">rev buf ++ a :: l = (rev buf ++ [a]) ++ l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> &lt;- app_assoc.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><p>Please note that it worked thanks to the universal quantification on
<span class="docutils literal">buf</span> in the induction hypothesis. It was made easier thanks to the
order of quantifications in the goal statement.</p>
<p>Ana's statement can be proved the same way, with a small bookkeeping
sequence before the induction:</p>
<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk21"><span class="kn">Goal</span> <span class="kr">forall</span> <span class="nv">p</span> <span class="nv">buf</span> <span class="nv">l</span>, rev buf ++ l = concat (split_string p buf l).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">p</span> : ascii -&gt; bool) (<span class="nv">buf</span> <span class="nv">l</span> : list ascii),
rev buf ++ l = concat (split_string p buf l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk22"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">p</span> : ascii -&gt; bool) (<span class="nv">buf</span> <span class="nv">l</span> : list ascii),
rev buf ++ l = concat (split_string p buf l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk23"><span class="nb">intros</span> p buf l; <span class="nb">revert</span> buf.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>p</var><span class="hyp-type"><b>: </b><span>ascii -&gt; bool</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list ascii</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">buf</span> : list ascii,
rev buf ++ l = concat (split_string p buf l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk24"><span class="nb">induction</span> l <span class="kr">as</span> [| a l IHl].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>p</var><span class="hyp-type"><b>: </b><span>ascii -&gt; bool</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">buf</span> : list ascii,
rev buf ++ [] = concat (split_string p buf [])</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk25" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>p</var><span class="hyp-type"><b>: </b><span>ascii -&gt; bool</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>ascii</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list ascii</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">buf</span> : list ascii, rev buf ++ l = concat (split_string p buf l)</span></span></span><br></div><label class="goal-separator" for="coq-implementation-of-splitstring-and-proof-that-nothing-gets-deleted-v-chk25"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">buf</span> : list ascii,
rev buf ++ a :: l =
concat (split_string p buf (a :: l))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  <span class="c">(* ... *)</span></span></pre></section>
</div>
</main>
</div></body>
</html>
