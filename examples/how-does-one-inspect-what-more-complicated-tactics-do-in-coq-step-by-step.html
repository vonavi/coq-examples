<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" class="alectryon-standalone" xml:lang="en" lang="en">
<head>
<meta charset="utf-8" />
<meta name="generator" content="Docutils 0.21.2: https://docutils.sourceforge.io/" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>How does one inspect what more complicated tactics do in Coq step-by-step?</title>
<link rel="stylesheet" href="alectryon.css" type="text/css" />
<link rel="stylesheet" href="docutils_basic.css" type="text/css" />
<link rel="stylesheet" href="pygments.css" type="text/css" />
<script type="text/javascript" src="alectryon.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="alectryon-root alectryon-centered"><main id="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step">
<h1 class="title">How does one inspect what more complicated tactics do in Coq step-by-step?</h1>
<dl class="docinfo simple">
<dt class="link">Link<span class="colon">:</span></dt>
<dd class="link"><p><a class="reference external" href="https://stackoverflow.com/q/54047766">https://stackoverflow.com/q/54047766</a></p>
</dd>
</dl>
<input type="checkbox" class="alectryon-toggle" id="alectryon-toggle-0" /><label for="alectryon-toggle-0" class="alectryon-toggle-label">Display all goals and responses</label><div class="alectryon-container docutils container">
<section id="question">
<h2>Question</h2>
<p>I was trying to go through the famous and wonderful <a class="reference external" href="https://softwarefoundations.cis.upenn.edu/lf-current/Basics.html#lab30">software
foundations book</a>
but I got to an example where <span class="docutils literal">simpl.</span> and <span class="docutils literal">reflexivity.</span> just do
to much under the covers and are hindering my learning &amp;
understanding.</p>
<p>I was going through the following theorem:</p>
<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk0"><span class="kn">Theorem</span> <span class="nf">plus_1_neq_0</span> : <span class="kr">forall</span> <span class="nv">n</span> : nat,
    beq_nat (n + <span class="mi">1</span>) <span class="mi">0</span> = false. <span class="c">(* n+1 != 0 *)</span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">n</span> : nat, PeanoNat.Nat.eqb (n + <span class="mi">1</span>) <span class="mi">0</span> = false</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">n</span> : nat, PeanoNat.Nat.eqb (n + <span class="mi">1</span>) <span class="mi">0</span> = false</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk2"><span class="nb">intros</span> n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">PeanoNat.Nat.eqb (n + <span class="mi">1</span>) <span class="mi">0</span> = false</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk3"><span class="nb">destruct</span> n <span class="kr">as</span> [| n&#39;].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">PeanoNat.Nat.eqb (<span class="mi">0</span> + <span class="mi">1</span>) <span class="mi">0</span> = false</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk4"><hr></label><div class="goal-conclusion">PeanoNat.Nat.eqb (S n&#39; + <span class="mi">1</span>) <span class="mi">0</span> = false</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">PeanoNat.Nat.eqb (<span class="mi">0</span> + <span class="mi">1</span>) <span class="mi">0</span> = false</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk6"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">false = false</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">PeanoNat.Nat.eqb (S n&#39; + <span class="mi">1</span>) <span class="mi">0</span> = false</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk8"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">false = false</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><p>what I really want is something that allows me to go through step by
step what <span class="docutils literal">simpl.</span> and <span class="docutils literal">reflexivity.</span> did. Is there something that
allows me to do that?</p>
<hr class="docutils" />
<p>Destruct is suppose to resolve the following issue:</p>
<blockquote>
<p>because the first argument to <span class="docutils literal">beq_nat</span> (which is just <span class="docutils literal">not equal</span> i.e. <span class="docutils literal">!=</span>) does a matching but the first input depends
on a unknown variable <span class="docutils literal">n</span> and the same thing for <span class="docutils literal">+</span> so the
matching can't do anything, so doing <span class="docutils literal">simpl.</span> gets us stuck (for
some reason).</p>
</blockquote>
<p>which it clearly it must resolve it since Coq later accepts the proof.
But if one looks carefully what the second goal is, it seems that the
same issue as above is re-introduced:</p>
<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input checked="checked" class="alectryon-toggle" id="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk9" style="display: none" type="checkbox"><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message"><span class="mi">2</span> subgoals

  ============================
  PeanoNat.Nat.eqb (<span class="mi">0</span> + <span class="mi">1</span>) <span class="mi">0</span> = false

subgoal <span class="mi">2</span> <span class="kr">is</span>:
 PeanoNat.Nat.eqb (S n&#39; + <span class="mi">1</span>) <span class="mi">0</span> = false</blockquote></div></div></small></span></pre><p>now we have <span class="docutils literal">n'</span> as the first argument for both <span class="docutils literal">beq_nat</span> and
<span class="docutils literal">+</span> again. However, to a novice like me, <span class="docutils literal">simpl.</span> miraculously
does work this time for some mysterious reason. I obviously read the
<span class="docutils literal">simpl.</span> <a class="reference external" href="https://coq.inria.fr/refman/proof-engine/tactics.html?highlight=simpl#coq:tacn.simpl">documentation</a>
but being a novice in this I didn't really know what I was looking for
and it was to dense for me to form an understanding of it that was
helpful...</p>
<p>Anyway, why does it work here? The reason I am asking is because it
would have never occurred to me to use destruct on this example proof,
especially cuz of the re ocurrence of <span class="docutils literal">n'</span> an unknown variable, and
it seems that being able to see what really happened or what was
different would be useful. So I thought checking a step-by-step break
down of these type of things would be useful (rather than posting a
new SO question every other day).</p>
<hr class="docutils" />
<p>Note I did see this question:</p>
<p><a class="reference external" href="https://stackoverflow.com/questions/39355817/step-by-step-simplification-in-coq">Step by step simplification in coq?</a></p>
<p>but I couldn't find a way to make it useful for me since it was
tailored for that particular example to much. Hopefully my question
doesn't become to narrow to my particular example, though it might
since the step by step break down might not be possible without
knowing how <span class="docutils literal">simpl.</span> (or <span class="docutils literal">reflexivity.</span>) works already (or at
least the above answers to the question above gave me that
impression).</p>
</section>
<section id="answer">
<h2>Answer</h2>
<p>One way to break the evaluation down is to give an argument to
<span class="docutils literal">simpl</span>, as suggested in <a class="reference external" href="https://stackoverflow.com/questions/39355817/step-by-step-simplification-in-coq">the question you linked</a>.
<span class="docutils literal">simpl f</span> allows to simplify only the sub-expressions that appear
under calls to <span class="docutils literal">f</span>. In this case, <span class="docutils literal">simpl Nat.add</span> (or <span class="docutils literal">simpl plus</span> or <span class="docutils literal">simpl &quot;+&quot;</span>) simplifies <span class="docutils literal">S n' + 1</span> into <span class="docutils literal">S (n' + 1)</span>.
Then <span class="docutils literal">simpl beq_nat</span> turns <span class="docutils literal">beq_nat (S (n' + 1)) 0</span> into
<span class="docutils literal">false</span>.</p>
<p>As for <span class="docutils literal">reflexivity</span>, it can conclude if the two terms under
comparison are equal up to simplification, which means that, if I am
not mistaken, you can always replace <span class="docutils literal">simpl; reflexivity</span> by just
<span class="docutils literal">reflexivity</span>.</p>
</section>
</div>
</main>
</div></body>
</html>
