<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="alectryon-standalone" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.20.1: https://docutils.sourceforge.io/" />
<title>How does one inspect what more complicated tactics do in Coq step-by-step?</title>
<link rel="stylesheet" href="alectryon.css" type="text/css" />
<link rel="stylesheet" href="docutils_basic.css" type="text/css" />
<link rel="stylesheet" href="pygments.css" type="text/css" />
<script type="text/javascript" src="alectryon.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="alectryon-root alectryon-centered"><div class="document" id="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step">
<h1 class="title">How does one inspect what more complicated tactics do in Coq step-by-step?</h1>
<table class="docinfo" frame="void" rules="none">
<col class="docinfo-name" />
<col class="docinfo-content" />
<tbody valign="top">
<tr class="link field"><th class="docinfo-name">Link:</th><td class="field-body"><a class="reference external" href="https://stackoverflow.com/q/54047766">https://stackoverflow.com/q/54047766</a></td>
</tr>
</tbody>
</table>
<input type="checkbox" class="alectryon-toggle" id="alectryon-toggle-0" /><label for="alectryon-toggle-0" class="alectryon-toggle-label">Display all goals and responses</label><div class="alectryon-container docutils container">
<div class="section" id="question">
<h1>Question</h1>
<p>I was trying to go through the famous and wonderful <a class="reference external" href="https://softwarefoundations.cis.upenn.edu/lf-current/Basics.html#lab30">software
foundations book</a>
but I got to an example where <tt class="docutils literal">simpl.</tt> and <tt class="docutils literal">reflexivity.</tt> just do
to much under the covers and are hindering my learning &amp;
understanding.</p>
<p>I was going through the following theorem:</p>
<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk0"><span class="kn">Theorem</span> <span class="nf">plus_1_neq_0</span> : <span class="kr">forall</span> <span class="nv">n</span> : nat,
    beq_nat (n + <span class="mi">1</span>) <span class="mi">0</span> = false. <span class="c">(* n+1 != 0 *)</span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">n</span> : nat, PeanoNat.Nat.eqb (n + <span class="mi">1</span>) <span class="mi">0</span> = false</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">n</span> : nat, PeanoNat.Nat.eqb (n + <span class="mi">1</span>) <span class="mi">0</span> = false</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk2"><span class="nb">intros</span> n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">PeanoNat.Nat.eqb (n + <span class="mi">1</span>) <span class="mi">0</span> = false</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk3"><span class="nb">destruct</span> n <span class="kr">as</span> [| n&#39;].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">PeanoNat.Nat.eqb (<span class="mi">0</span> + <span class="mi">1</span>) <span class="mi">0</span> = false</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk4"><hr></label><div class="goal-conclusion">PeanoNat.Nat.eqb (S n&#39; + <span class="mi">1</span>) <span class="mi">0</span> = false</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">PeanoNat.Nat.eqb (<span class="mi">0</span> + <span class="mi">1</span>) <span class="mi">0</span> = false</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk6"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">false = false</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">PeanoNat.Nat.eqb (S n&#39; + <span class="mi">1</span>) <span class="mi">0</span> = false</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk8"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">false = false</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><p>what I really want is something that allows me to go through step by
step what <tt class="docutils literal">simpl.</tt> and <tt class="docutils literal">reflexivity.</tt> did. Is there something that
allows me to do that?</p>
<hr class="docutils" />
<p>Destruct is suppose to resolve the following issue:</p>
<blockquote>
because the first argument to <tt class="docutils literal">beq_nat</tt> (which is just <tt class="docutils literal">not
equal</tt> i.e. <tt class="docutils literal">!=</tt>) does a matching but the first input depends
on a unknown variable <tt class="docutils literal">n</tt> and the same thing for <tt class="docutils literal">+</tt> so the
matching can't do anything, so doing <tt class="docutils literal">simpl.</tt> gets us stuck (for
some reason).</blockquote>
<p>which it clearly it must resolve it since Coq later accepts the proof.
But if one looks carefully what the second goal is, it seems that the
same issue as above is re-introduced:</p>
<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input checked="checked" class="alectryon-toggle" id="how-does-one-inspect-what-more-complicated-tactics-do-in-coq-step-by-step-v-chk9" style="display: none" type="checkbox"><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message"><span class="mi">2</span> subgoals

  ============================
  PeanoNat.Nat.eqb (<span class="mi">0</span> + <span class="mi">1</span>) <span class="mi">0</span> = false

subgoal <span class="mi">2</span> <span class="kr">is</span>:
 PeanoNat.Nat.eqb (S n&#39; + <span class="mi">1</span>) <span class="mi">0</span> = false</blockquote></div></div></small></span></pre><p>now we have <tt class="docutils literal">n'</tt> as the first argument for both <tt class="docutils literal">beq_nat</tt> and
<tt class="docutils literal">+</tt> again. However, to a novice like me, <tt class="docutils literal">simpl.</tt> miraculously
does work this time for some mysterious reason. I obviously read the
<tt class="docutils literal">simpl.</tt> <a class="reference external" href="https://coq.inria.fr/refman/proof-engine/tactics.html?highlight=simpl#coq:tacn.simpl">documentation</a>
but being a novice in this I didn't really know what I was looking for
and it was to dense for me to form an understanding of it that was
helpful...</p>
<p>Anyway, why does it work here? The reason I am asking is because it
would have never occurred to me to use destruct on this example proof,
especially cuz of the re ocurrence of <tt class="docutils literal">n'</tt> an unknown variable, and
it seems that being able to see what really happened or what was
different would be useful. So I thought checking a step-by-step break
down of these type of things would be useful (rather than posting a
new SO question every other day).</p>
<hr class="docutils" />
<p>Note I did see this question:</p>
<p><a class="reference external" href="https://stackoverflow.com/questions/39355817/step-by-step-simplification-in-coq">Step by step simplification in coq?</a></p>
<p>but I couldn't find a way to make it useful for me since it was
tailored for that particular example to much. Hopefully my question
doesn't become to narrow to my particular example, though it might
since the step by step break down might not be possible without
knowing how <tt class="docutils literal">simpl.</tt> (or <tt class="docutils literal">reflexivity.</tt>) works already (or at
least the above answers to the question above gave me that
impression).</p>
</div>
<div class="section" id="answer">
<h1>Answer</h1>
<p>One way to break the evaluation down is to give an argument to
<tt class="docutils literal">simpl</tt>, as suggested in <a class="reference external" href="https://stackoverflow.com/questions/39355817/step-by-step-simplification-in-coq">the question you linked</a>.
<tt class="docutils literal">simpl f</tt> allows to simplify only the sub-expressions that appear
under calls to <tt class="docutils literal">f</tt>. In this case, <tt class="docutils literal">simpl Nat.add</tt> (or <tt class="docutils literal">simpl
plus</tt> or <tt class="docutils literal">simpl &quot;+&quot;</tt>) simplifies <tt class="docutils literal">S n' + 1</tt> into <tt class="docutils literal">S (n' + 1)</tt>.
Then <tt class="docutils literal">simpl beq_nat</tt> turns <tt class="docutils literal">beq_nat (S (n' + 1)) 0</tt> into
<tt class="docutils literal">false</tt>.</p>
<p>As for <tt class="docutils literal">reflexivity</tt>, it can conclude if the two terms under
comparison are equal up to simplification, which means that, if I am
not mistaken, you can always replace <tt class="docutils literal">simpl; reflexivity</tt> by just
<tt class="docutils literal">reflexivity</tt>.</p>
</div>
</div>
</div>
</div></body>
</html>
