<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" class="alectryon-standalone" xml:lang="en" lang="en">
<head>
<meta charset="utf-8" />
<meta name="generator" content="Docutils 0.20.1: https://docutils.sourceforge.io/" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>What does it mean when Coq expands a function as part of the goal?</title>
<link rel="stylesheet" href="alectryon.css" type="text/css" />
<link rel="stylesheet" href="docutils_basic.css" type="text/css" />
<link rel="stylesheet" href="pygments.css" type="text/css" />
<script type="text/javascript" src="alectryon.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="alectryon-root alectryon-centered"><main id="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal">
<h1 class="title">What does it mean when Coq expands a function as part of the goal?</h1>
<dl class="docinfo simple">
<dt class="link">Link<span class="colon">:</span></dt>
<dd class="link"><p><a class="reference external" href="https://stackoverflow.com/q/54336455">https://stackoverflow.com/q/54336455</a></p>
</dd>
</dl>
<input type="checkbox" class="alectryon-toggle" id="alectryon-toggle-0" /><label for="alectryon-toggle-0" class="alectryon-toggle-label">Display all goals and responses</label><div class="alectryon-container docutils container">
<section id="question">
<h2>Question</h2>
<p>I was trying to solve the following theorem and got stuck at the last
<span class="docutils literal">simpl.</span>:</p>
<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk0"><span class="kn">Lemma</span> <span class="nf">nonzeros_app</span> : <span class="kr">forall</span> <span class="nv">l1</span> <span class="nv">l2</span> : natlist,
    nonzeros (l1 ++ l2) = (nonzeros l1) ++ (nonzeros l2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">l1</span> <span class="nv">l2</span> : natlist,
nonzeros (l1 ++ l2) = nonzeros l1 ++ nonzeros l2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">l1</span> <span class="nv">l2</span> : natlist,
nonzeros (l1 ++ l2) = nonzeros l1 ++ nonzeros l2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk2"><span class="nb">intros</span> l1 l2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>natlist</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nonzeros (l1 ++ l2) = nonzeros l1 ++ nonzeros l2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk3"><span class="nb">induction</span> l1 <span class="kr">as</span> [| n&#39; l&#39; IHl&#39;].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>natlist</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nonzeros ([] ++ l2) = nonzeros [] ++ nonzeros l2</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list nat</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>natlist</span></span></span><br><span><var>IHl'</var><span class="hyp-type"><b>: </b><span>nonzeros (l&#39; ++ l2) =
nonzeros l&#39; ++ nonzeros l2</span></span></span><br></div><label class="goal-separator" for="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk4"><hr></label><div class="goal-conclusion">nonzeros ((n&#39; :: l&#39;) ++ l2) =
nonzeros (n&#39; :: l&#39;) ++ nonzeros l2</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>natlist</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nonzeros ([] ++ l2) = nonzeros [] ++ nonzeros l2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk6"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>natlist</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nonzeros l2 = nonzeros l2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list nat</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>natlist</span></span></span><br><span><var>IHl'</var><span class="hyp-type"><b>: </b><span>nonzeros (l&#39; ++ l2) =
nonzeros l&#39; ++ nonzeros l2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nonzeros ((n&#39; :: l&#39;) ++ l2) =
nonzeros (n&#39; :: l&#39;) ++ nonzeros l2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk8"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list nat</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>natlist</span></span></span><br><span><var>IHl'</var><span class="hyp-type"><b>: </b><span>nonzeros (l&#39; ++ l2) =
nonzeros l&#39; ++ nonzeros l2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">match</span> n&#39; <span class="kr">with</span>
| <span class="mi">0</span> =&gt; nonzeros (l&#39; ++ l2)
| S _ =&gt; n&#39; :: nonzeros (l&#39; ++ l2)
<span class="kr">end</span> =
<span class="kr">match</span> n&#39; <span class="kr">with</span>
| <span class="mi">0</span> =&gt; nonzeros l&#39;
| S _ =&gt; n&#39; :: nonzeros l&#39;
<span class="kr">end</span> ++ nonzeros l2</div></blockquote></div></div></small></span></pre><p>at that point Coq changes the goal from:</p>
<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input checked="checked" class="alectryon-toggle" id="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk9" style="display: none" type="checkbox"><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message"><span class="mi">1</span> subgoal

  n&#39; : nat
  l&#39; : list nat
  l2 : natlist
  IHl&#39; : nonzeros (l&#39; ++ l2) =
         nonzeros l&#39; ++ nonzeros l2
  ============================
  nonzeros ((n&#39; :: l&#39;) ++ l2) =
  nonzeros (n&#39; :: l&#39;) ++ nonzeros l2</blockquote></div></div></small></span></pre><p>to:</p>
<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input checked="checked" class="alectryon-toggle" id="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chka" style="display: none" type="checkbox"><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message"><span class="mi">1</span> subgoal

  n&#39; : nat
  l&#39; : list nat
  l2 : natlist
  IHl&#39; : nonzeros (l&#39; ++ l2) =
         nonzeros l&#39; ++ nonzeros l2
  ============================
  <span class="kr">match</span> n&#39; <span class="kr">with</span>
  | <span class="mi">0</span> =&gt; nonzeros (l&#39; ++ l2)
  | S _ =&gt; n&#39; :: nonzeros (l&#39; ++ l2)
  <span class="kr">end</span> =
  <span class="kr">match</span> n&#39; <span class="kr">with</span>
  | <span class="mi">0</span> =&gt; nonzeros l&#39;
  | S _ =&gt; n&#39; :: nonzeros l&#39;
  <span class="kr">end</span> ++ nonzeros l2</blockquote></div></div></small></span></pre><p>which seems completely mysterious to me. What does it mean when Coq
just copy pastes the definition of a function into my goal? What do I
even do with this?</p>
<hr class="docutils" />
<section id="context-of-question">
<h3>Context of Question:</h3>
<p>Someone told me that the solution is:</p>
<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chkb"><span class="kn">Lemma</span> <span class="nf">nonzeros_app</span> : <span class="kr">forall</span> <span class="nv">l1</span> <span class="nv">l2</span> : natlist,
    nonzeros (l1 ++ l2) = (nonzeros l1) ++ (nonzeros l2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">l1</span> <span class="nv">l2</span> : natlist,
nonzeros (l1 ++ l2) = nonzeros l1 ++ nonzeros l2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chkc"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">l1</span> <span class="nv">l2</span> : natlist,
nonzeros (l1 ++ l2) = nonzeros l1 ++ nonzeros l2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chkd"><span class="nb">intros</span> l1 l2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>natlist</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nonzeros (l1 ++ l2) = nonzeros l1 ++ nonzeros l2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chke"><span class="nb">induction</span> l1 <span class="kr">as</span> [| n&#39; l&#39; IHl&#39;].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>natlist</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nonzeros ([] ++ l2) = nonzeros [] ++ nonzeros l2</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chkf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list nat</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>natlist</span></span></span><br><span><var>IHl'</var><span class="hyp-type"><b>: </b><span>nonzeros (l&#39; ++ l2) =
nonzeros l&#39; ++ nonzeros l2</span></span></span><br></div><label class="goal-separator" for="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chkf"><hr></label><div class="goal-conclusion">nonzeros ((n&#39; :: l&#39;) ++ l2) =
nonzeros (n&#39; :: l&#39;) ++ nonzeros l2</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk10">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>natlist</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nonzeros ([] ++ l2) = nonzeros [] ++ nonzeros l2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk11"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>natlist</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nonzeros l2 = nonzeros l2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk12">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list nat</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>natlist</span></span></span><br><span><var>IHl'</var><span class="hyp-type"><b>: </b><span>nonzeros (l&#39; ++ l2) =
nonzeros l&#39; ++ nonzeros l2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nonzeros ((n&#39; :: l&#39;) ++ l2) =
nonzeros (n&#39; :: l&#39;) ++ nonzeros l2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk13"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list nat</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>natlist</span></span></span><br><span><var>IHl'</var><span class="hyp-type"><b>: </b><span>nonzeros (l&#39; ++ l2) =
nonzeros l&#39; ++ nonzeros l2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">match</span> n&#39; <span class="kr">with</span>
| <span class="mi">0</span> =&gt; nonzeros (l&#39; ++ l2)
| S _ =&gt; n&#39; :: nonzeros (l&#39; ++ l2)
<span class="kr">end</span> =
<span class="kr">match</span> n&#39; <span class="kr">with</span>
| <span class="mi">0</span> =&gt; nonzeros l&#39;
| S _ =&gt; n&#39; :: nonzeros l&#39;
<span class="kr">end</span> ++ nonzeros l2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk14">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list nat</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>natlist</span></span></span><br><span><var>IHl'</var><span class="hyp-type"><b>: </b><span>nonzeros (l&#39; ++ l2) =
nonzeros l&#39; ++ nonzeros l2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">match</span> n&#39; <span class="kr">with</span>
| <span class="mi">0</span> =&gt; nonzeros (l&#39; ++ l2)
| S _ =&gt; n&#39; :: nonzeros (l&#39; ++ l2)
<span class="kr">end</span> =
<span class="kr">match</span> n&#39; <span class="kr">with</span>
| <span class="mi">0</span> =&gt; nonzeros l&#39;
| S _ =&gt; n&#39; :: nonzeros l&#39;
<span class="kr">end</span> ++ nonzeros l2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk15"><span class="nb">induction</span> n&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l'</var><span class="hyp-type"><b>: </b><span>list nat</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>natlist</span></span></span><br><span><var>IHl'</var><span class="hyp-type"><b>: </b><span>nonzeros (l&#39; ++ l2) =
nonzeros l&#39; ++ nonzeros l2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nonzeros (l&#39; ++ l2) = nonzeros l&#39; ++ nonzeros l2</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk16" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list nat</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>natlist</span></span></span><br><span><var>IHl'</var><span class="hyp-type"><b>: </b><span>nonzeros (l&#39; ++ l2) =
nonzeros l&#39; ++ nonzeros l2</span></span></span><br><span><var>IHn'</var><span class="hyp-type"><b>: </b><span><span class="kr">match</span> n&#39; <span class="kr">with</span>
| <span class="mi">0</span> =&gt; nonzeros (l&#39; ++ l2)
| S _ =&gt; n&#39; :: nonzeros (l&#39; ++ l2)
<span class="kr">end</span> =
<span class="kr">match</span> n&#39; <span class="kr">with</span>
| <span class="mi">0</span> =&gt; nonzeros l&#39;
| S _ =&gt; n&#39; :: nonzeros l&#39;
<span class="kr">end</span> ++ nonzeros l2</span></span></span><br></div><label class="goal-separator" for="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk16"><hr></label><div class="goal-conclusion">S n&#39; :: nonzeros (l&#39; ++ l2) =
(S n&#39; :: nonzeros l&#39;) ++ nonzeros l2</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">             </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk17">- <span class="c">(* ... *)</span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l'</var><span class="hyp-type"><b>: </b><span>list nat</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>natlist</span></span></span><br><span><var>IHl'</var><span class="hyp-type"><b>: </b><span>nonzeros (l&#39; ++ l2) =
nonzeros l&#39; ++ nonzeros l2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nonzeros (l&#39; ++ l2) = nonzeros l&#39; ++ nonzeros l2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">             </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="what-does-it-mean-when-coq-expands-a-function-as-part-of-the-goal-v-chk18">- <span class="c">(* ... *)</span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list nat</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>natlist</span></span></span><br><span><var>IHl'</var><span class="hyp-type"><b>: </b><span>nonzeros (l&#39; ++ l2) =
nonzeros l&#39; ++ nonzeros l2</span></span></span><br><span><var>IHn'</var><span class="hyp-type"><b>: </b><span><span class="kr">match</span> n&#39; <span class="kr">with</span>
| <span class="mi">0</span> =&gt; nonzeros (l&#39; ++ l2)
| S _ =&gt; n&#39; :: nonzeros (l&#39; ++ l2)
<span class="kr">end</span> =
<span class="kr">match</span> n&#39; <span class="kr">with</span>
| <span class="mi">0</span> =&gt; nonzeros l&#39;
| S _ =&gt; n&#39; :: nonzeros l&#39;
<span class="kr">end</span> ++ nonzeros l2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S n&#39; :: nonzeros (l&#39; ++ l2) =
(S n&#39; :: nonzeros l&#39;) ++ nonzeros l2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">}</span><span class="alectryon-wsp">
</span></span></pre><p>which made me want to understand why they use induction on <span class="docutils literal">n'</span>
since it feels it would never occur to me to use induction there. So I
am asking, why? But I realized that before I could ask that why I
didn't even understand the proof state before that since it just
seemed to copy paste a function to a proof state (which makes no sense
to me). So before I asked why use induction there I have to ask what
does the proof state before that, maybe that would yield light into
why induction on <span class="docutils literal">n'</span>.</p>
</section>
</section>
<section id="answer">
<h2>Answer</h2>
<p>I am assuming that you have defined <span class="docutils literal">nonzeros</span> in the following way
(or similar):</p>
<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> List.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Import</span> ListNotations.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">natlist</span> := list nat.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">nonzeros</span> (<span class="nv">l</span> : natlist) :=
  <span class="kr">match</span> l <span class="kr">with</span>
  | [] =&gt; []
  | <span class="mi">0</span> :: xs =&gt; nonzeros xs
  | x :: xs =&gt; x :: nonzeros xs
  <span class="kr">end</span>.</span></span></pre><p>So that <span class="docutils literal">nonzeros</span> is recursive with structural decreasing on <span class="docutils literal">l</span>.
Coq's <span class="docutils literal">simpl</span> tactic employs a heuristic in which it unfolds
definitions of fixpoints if they are applied to a term that has a
constructor as the head symbol. In your case, e.g., <span class="docutils literal">nonzeros (n' :: l')</span>, the constant <span class="docutils literal">nonzeros</span> is followed by a term formed by a
constructor, <span class="docutils literal">Cons</span> (=<span class="docutils literal">::</span>). Coq performs a so-called &quot;delta
reduction&quot;, replacing the occurrence of <span class="docutils literal">nonzeros</span> with its
definition. Since that definition is a <span class="docutils literal">match</span>, you get a <span class="docutils literal">match</span>
as your new term. Further substitutions do simplify it a bit, but
cannot eliminate the two cases: one for zero head and one for nonzero
head.</p>
<p>Same happens to the occurrence <span class="docutils literal">nonzeros ((n' :: l') ++ l2)</span>, which
is first simplified to <span class="docutils literal">nonzeros (n' :: (l' ++ l2))</span>, so that again,
the head of the argument is <span class="docutils literal">Cons</span>.</p>
<p>If you want to avoid exposing <span class="docutils literal">match</span> expressions when simplifying,
you can put the following directive after the definition of
<span class="docutils literal">nonzeros</span>:</p>
<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> nonzeros l : <span class="nb">simpl</span> nomatch.</span></span></pre><p>This specifically tells <span class="docutils literal">simpl</span> to avoid expanding a term if this
will end up exposing a <span class="docutils literal">match</span> at the location of the change.</p>
<p>As for the <span class="docutils literal">induction</span> used by your friend here: it is applied to
force a case split over <span class="docutils literal">n'</span>, so that each case (<span class="docutils literal">n' = 0</span>, <span class="docutils literal">n' = S _</span>) can be handled separately. Indeed, induction is not needed
here. A simple case split (<span class="docutils literal">case n'</span>) will do the same.</p>
</section>
</div>
</main>
</div></body>
</html>
